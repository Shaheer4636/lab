# Path to the file containing the embedded script
$filePath = "C:\path\to\script.txt"

# Read the file content
$content = Get-Content -Path $filePath -Raw

# Extract the script between <powershell> and </powershell>
$scriptContent = ($content -split '<powershell>')[1] -split '</powershell>' | Select-Object -First 1

# Option 1: Save to a .ps1 file and execute
$scriptContent | Out-File -FilePath "C:\path\to\extracted_script.ps1"
& "C:\path\to\extracted_script.ps1"

# Option 2: Execute the script directly
Invoke-Expression -Command $scriptContent
