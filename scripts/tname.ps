#!/usr/bin/env bash
set -euo pipefail

# Hard-set the artifact path used in Release
AEM_DEPLOY_ARTIFACT_FOLDER="$(System.DefaultWorkingDirectory)/_bsro-aem-shared/zip-artifacts"

echo "Checking artifact folder: $AEM_DEPLOY_ARTIFACT_FOLDER"
parent="$(dirname "$AEM_DEPLOY_ARTIFACT_FOLDER")"
echo "Listing parent: $parent"
ls -la "$parent" || true

if [ -d "$AEM_DEPLOY_ARTIFACT_FOLDER" ]; then
  echo "##vso[task.setvariable variable=shouldDeploy;]True"
  echo "Artifact folder exists. Proceeding."
else
  echo "##vso[task.setvariable variable=shouldDeploy;]False"
  echo "Artifact folder NOT found. Skipping."
fi
